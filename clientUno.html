<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Monkey Uno Game</title>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive, sans-serif;
      background-color: #ffeecc;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    #game-container {
      text-align: center;
      padding: 20px;
      background-color: #f8d49d;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    h3, h4 {
      color: #8b4513; /* Saddle Brown */
    }

    #texteId, #main, #mainA, #terrain {
      margin-bottom: 10px;
    }

    input[type="text"], input[type="button"] {
      padding: 10px;
      margin: 5px;
      font-size: 16px;
      border-radius: 4px;
      cursor: pointer;
      color: #000;
      border: none;
    }

    input[type="text"] {
      width: 150px;
    }

    input[type="button"]:enabled {
      background-color: #8b4513; /* Saddle Brown */
    }

    input[type="button"]:hover {
      background-color: #a0522d; /* Sienna */
    }

    input[type="button"]:disabled {
      background-color: #ccc; /* Light Gray */
      cursor: not-allowed;
    }

    audio {
      margin-top: 20px;
    }
  </style>
</head>
<body>

<div id="game-container">
  <h3>
    <div id="texteId"></div>
    <div id="main"></div>
    <br>
    <div id="mainA"></div>
  </h3>
  <br>
  <h4>
    <div id="terrain">Aucune carte</div>
  </h4>
  <br>

  <input type="text" id="poseTbx" placeholder="Entrez la carte à poser">
  <input type='button' id="bouton" value="Poser une carte" disabled=true></input>
  <input type='button' id="pioche" value="Pioche" disabled=true></input>
  <input type='button' id="rouge" value="Rouge" disabled=true></input>
  <input type='button' id="bleu" value="Bleu" disabled=true></input>
  <input type='button' id="vert" value="Vert" disabled=true></input>
  <input type='button' id="jaune" value="Jaune" disabled=true></input>
</div>
<script>

    var bouton = document.getElementById('bouton');
    var bouton2 = document.getElementById('finTour');

    //Actualisation des textes
    socket.on('id', function (donnee) {
        $('#texteId').html(donnee);
    });
    socket.on('data', function (donnee) {
        $('#main').html(donnee);
    });
    socket.on('mainA', function (donnee) {
        $('#mainA').html(donnee);
    })
    socket.on('terrain', function (donnee) {
        $('#terrain').html(donnee);
    })

    //Récupération clics boutons
    $('#bouton').mousedown(function () {
        var textBox = document.getElementById('poseTbx');
        socket.emit('appel', textBox.value);
    });
    $('#pioche').mousedown(function () {
        socket.emit('piocher');
        bouton.disabled = true;
        pioche.disabled = true;
    });
    $('#rouge').mousedown(function () {
        clicCouleur('rouge');
    });
    $('#bleu').mousedown(function () {
        clicCouleur('bleu');
    });
    $('#vert').mousedown(function () {
        clicCouleur('vert');
    });
    $('#jaune').mousedown(function () {
        clicCouleur('jaune');
    });

    //Ecoute des requêtes
    socket.on('activation', function () {//Active l'interface du joueur dont c'est le tour
        bouton.disabled = false;
        pioche.disabled = false;
    });
    socket.on('desactivation', function () {//Désactive les interfaces de tous les joueurs en début de partie
        desactivation();
    });
    socket.on('entreeIncorrecte', function() {//Affiche le texte indiquant que le texte de la carte est incorrect
      var textBox = document.getElementById('poseTbx');
      textBox.value = 'Entrée incorrecte';
    });
    socket.on('victoire', function() {//Affiche le message de victoire
        desactivation();
        alert('Vous avez gagné !');
    });
    socket.on('defaite', function(donnee) {//Affiche le message de défaite
        alert('Vous avez perdu... Partie remportée par ' + donnee);
    });
    socket.on('carteEnJeu', function(donnee) {//Modifie la carte sur le tapis
        $('#terrain').html(donnee);
        bouton.disabled = true;
        pioche.disabled = true;
    });
    socket.on('carteStop', function() {//Renvoi de la requête
        socket.emit('stop');
    });
    socket.on('menuStop', function() {//N'affiche que le bouton pour poser une carte Stop (le serveur envoie la requête lorsque le joueur a une carte Stop)
        bouton.disabled = false;
        pioche.disabled = true;
    });
    socket.on('plusDeCartes', function(tailleMain, nbJoueurAPasser, idGagnant) {//Boucle de requêtes pour trouver le joueur avec la main la plus petite lorsque le paquet est vide
        socket.emit('0Cartes', tailleMain, nbJoueurAPasser, idGagnant);
    });
    socket.on('finPartieCartes', function(tailleMain, idGagnant) {//Affiche le message de fin de partie une fois que le vainceur a été trouvé par le serveur
        alert('Partie finie par épuisement de cartes, le vainceur est ' + idGagnant + ' avec ' + tailleMain + ' cartes.');
    });
    socket.on('choixCouleur', function() {//Active les boutons pour choisir la couleur en cas de carte de changement de couleur
        rouge.disabled = false;
        bleu.disabled = false;
        vert.disabled = false;
        jaune.disabled = false;
        bouton.disabled = true;
        pioche.disabled = true;
        
    });
    socket.on('uno', function(donnee){//Affiche le message de Uno
        alert('Uno !\n' + donnee + ' n\'a plus qu\'une seule carte !')   
    });

    //Désactive les interfaces de tous les joueurs en début de partie
    function desactivation() {
        bouton.disabled = true;
        pioche.disabled = true;
        rouge.disabled = true;
        bleu.disabled = true;
        vert.disabled = true;
        jaune.disabled = true;
    }

    //Désactive tous les boutons de couleur et envoie une requête au serveur pour indiquer la couleur cliquée
    function clicCouleur(couleur) {
        rouge.disabled = true;
        bleu.disabled = true;
        vert.disabled = true;
        jaune.disabled = true;
        socket.emit('couleurChoisie', couleur);
    }
</script>


</body>
</html>